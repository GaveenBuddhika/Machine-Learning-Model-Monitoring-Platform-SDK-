{
  "editable": true,
  "refresh": "5s",
  "title": "ML Model Observability - Sidecar Edition",
  "uid": "ml_sidecar_obs",
  "schemaVersion": 36,
  "style": "dark",
  "time": { "from": "now-30m", "to": "now" },
  "panels": [
    {
      "title": "Category 1: Model Quality & Performance",
      "type": "row",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 0 }
    },
    {
      "title": "F1-Score (Performance)",
      "type": "gauge",
      "gridPos": { "h": 8, "w": 8, "x": 0, "y": 1 },
      "targets": [ { "expr": "model_f1_score", "refId": "A" } ],
      "fieldConfig": { "defaults": { "min": 0, "max": 1, "thresholds": { "steps": [{ "color": "red", "value": null }, { "color": "orange", "value": 0.5 }, { "color": "green", "value": 0.8 }] } } }
    },
    {
      "title": "Precision & Recall (%)",
      "type": "stat",
      "gridPos": { "h": 8, "w": 8, "x": 8, "y": 1 },
      "targets": [
        { "expr": "model_precision_score * 100", "legendFormat": "Precision", "refId": "A" },
        { "expr": "model_recall_score * 100", "legendFormat": "Recall", "refId": "B" }
      ],
      "options": { "colorMode": "value", "graphMode": "area" },
      "fieldConfig": {
        "defaults": {
          "unit": "percent",
          "min": 0,
          "max": 100,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "red", "value": null },
              { "color": "green", "value": 70 }
            ]
          }
        }
      }
    },
    {
      "title": "Total Predictions",
      "type": "stat",
      "gridPos": { "h": 8, "w": 8, "x": 16, "y": 1 },
      "targets": [ { "expr": "predictions_total", "refId": "A" } ],
      "options": { "colorMode": "background" }
    },
    {
      "title": "Category 2: Data Drift & Feature Observability",
      "type": "row",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 9 }
    },
    {
      "title": "Data Drift Score (KS-Test)",
      "type": "gauge",
      "gridPos": { "h": 8, "w": 8, "x": 0, "y": 10 },
      "targets": [ { "expr": "model_drift_score", "refId": "A" } ],
      "fieldConfig": { "defaults": { "min": 0, "max": 1, "thresholds": { "steps": [{ "color": "green", "value": null }, { "color": "orange", "value": 0.4 }, { "color": "red", "value": 0.7 }] } } }
    },
    {
      "title": "Prediction Probability Trend",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 16, "x": 8, "y": 10 },
      "targets": [
        { "expr": "avg_over_time(model_drift_score[5m])", "legendFormat": "Average Drift (5m Window)", "refId": "A" }
      ]
    },
    {
      "title": "Category 3: Operational Throughput",
      "type": "row",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 18 }
    },
    {
      "title": "Requests Per Minute",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 24, "x": 0, "y": 19 },
      "targets": [
        { "expr": "rate(predictions_total[1m]) * 60", "legendFormat": "Predictions / Min", "refId": "A" }
      ],
      "options": { "legend": { "displayMode": "table" } }
    },
    { 
      "title": "Category 4: Infrastructure Health",
      "type": "row",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 27 }
    },
    {
      "title": "CPU Usage %",
      "type": "gauge",
      "gridPos": { "h": 8, "w": 8, "x": 0, "y": 28 },
      "targets": [
        { "expr": "system_cpu_usage_percent", "legendFormat": "CPU %", "refId": "A" }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "percent",
          "min": 0,
          "max": 100,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "orange", "value": 70 },
              { "color": "red", "value": 90 }
            ]
          }
        }
      }
    },
    {
      "title": "Memory Usage %",
      "type": "gauge",
      "gridPos": { "h": 8, "w": 8, "x": 8, "y": 28 },
      "targets": [
        { "expr": "system_memory_usage_percent", "legendFormat": "Memory %", "refId": "A" }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "percent",
          "min": 0,
          "max": 100,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "orange", "value": 70 },
              { "color": "red", "value": 90 }
            ]
          }
        }
      }
    },
    {
      "title": "Disk Usage %",
      "type": "gauge",
      "gridPos": { "h": 8, "w": 8, "x": 16, "y": 28 },
      "targets": [
        { "expr": "system_disk_usage_percent", "legendFormat": "Disk %", "refId": "A" }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "percent",
          "min": 0,
          "max": 100,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "orange", "value": 70 },
              { "color": "red", "value": 90 }
            ]
          }
        }
      }
    }
  ]
}